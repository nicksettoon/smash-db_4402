#Nicklaus Settoon
#894473560
#nsetto3@lsu.edu

#A
INSERT INTO movies
	(movie_id, name, score)
	VALUES(12345, 'strangemovie', 0);

SELECT * FROM movies
	WHERE movie_id = 12345;

#B
UPDATE movies
	SET name = 'badmovie'
	WHERE movie_id=12345;

SELECT * FROM movies
	WHERE movie_id = 12345;

#C
DELETE FROM movies
	WHERE movie_id = 12345;

SELECT * FROM movies
	WHERE movie_id = 12345;

#D
SELECT movie_id, name
	FROM movies
	WHERE name LIKE '%Warrior%';

#E
SELECT cast_id, cast_name, COUNT(movie_id) as num_movies
	FROM cast
	GROUP BY cast_name
	HAVING num_movies = 4
	ORDER BY cast_name;


#F
SELECT m.movie_id, score
	FROM movies as m, cast as c
	WHERE m.movie_id=c.movie_id AND score > 80 AND cast_name NOT LIKE '%David%'
	GROUP BY m.movie_id;

#G
SELECT cast_id, cast_name, COUNT(movies.movie_id) as num_movies, AVG(score) as average_score
	FROM movies,cast
	WHERE movies.movie_id=cast.movie_id AND score > 0
	GROUP BY cast_name
	ORDER BY cast_name;

#H
SELECT name FROM movies
	WHERE score > SOME (SELECT name
				FROM movies
				WHERE name LIKE '%Chronicles%');

#I
DROP VIEW collaboration;
CREATE VIEW collaboration AS
SELECT c1.cast_name as cast_member_id1, c2.cast_name as cast_member_id2, COUNT(c1.movie_id) as num_movies, AVG(score) as avg_movie_score
	FROM cast as c1, cast as c2 NATURAL INNER JOIN movies
	WHERE c1.movie_id=c2.movie_id AND c1.cast_id<>c2.cast_id AND score>=75
	GROUP BY c1.cast_name, c2.cast_name
	HAVING num_movies>=4;

SELECT * FROM collaboration
	ORDER BY avg_movie_score;
